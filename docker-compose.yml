services:
  ib-gateway:
    image: ib-gateway
    build:
      context: ./build
      dockerfile: Dockerfile
      args:
        PROGRAM: ibgateway
        RELEASE: stable
        ARCH: x64
    container_name: gateway
    restart: always
    network_mode: host
    environment:
      # VNC server password. If not defined, then VNC server will NOT start.
      VNC_PWD: tws
      VNC_SCREEN_DIMENSION: ${VNC_SCREEN_DIMENSION:-1600x1200x24}
      # live or paper.
      TRADING_MODE: ${TRADING_MODE:-paper}
      IB_USER: ${IB_USER}
      IB_PASSWORD: ${IB_PASSWORD}
  ib-tws:
    image: ib-tws
    build:
      context: ./build
      dockerfile: Dockerfile
      args:
        PROGRAM: tws
        RELEASE: stable
        ARCH: x64
    container_name: tws
    restart: always
    network_mode: host
    security_opt:
      - seccomp:unconfined
    shm_size: 2g
    environment:
      # User `uid` to run the container as (1000 is host user)
      PUID: 1000
      # User `gid` to run the container as (1000 is host user)
      PGID: 1000
      # VNC server password. If not defined, then VNC server will NOT start.
      VNC_PWD: tws
      VNC_SCREEN_DIMENSION: ${VNC_SCREEN_DIMENSION:-1600x1200x24}
      # live or paper.
      TRADING_MODE: ${TRADING_MODE:-paper}
      IB_USER: ${IB_USER}
      IB_PASSWORD: ${IB_PASSWORD}
